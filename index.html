<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Energy-Efficient CPU Scheduling Simulator</title>

<style>
body{
    margin:0;
    font-family:Arial, Helvetica, sans-serif;
    background:#0f172a;
    color:#e5e7eb;
}
header{
    text-align:center;
    padding:30px;
    background:linear-gradient(135deg,#2563eb,#1e40af);
}
.container{
    max-width:1100px;
    margin:20px auto;
    padding:20px;
}
.card{
    background:#020617;
    padding:20px;
    margin-bottom:20px;
    border-radius:12px;
    box-shadow:0 8px 18px rgba(0,0,0,0.4);
}
h2{ color:#60a5fa; }

input, button{
    padding:8px;
    margin:5px;
    border-radius:6px;
    border:none;
}
input{ width:120px; }

button{
    background:#22c55e;
    color:#020617;
    cursor:pointer;
    font-weight:bold;
}
button:hover{ background:#16a34a; }

table{
    width:100%;
    border-collapse:collapse;
    margin-top:10px;
}
th, td{
    border:1px solid #334155;
    padding:8px;
    text-align:center;
}
th{ background:#1e293b; }

.high{ color:#22c55e; font-weight:bold; }
.medium{ color:#38bdf8; font-weight:bold; }
.low{ color:#facc15; font-weight:bold; }

.delete-btn{
    background:#ef4444;
    color:white;
}
.delete-btn:hover{ background:#dc2626; }

.reset-btn{
    background:#f97316;
    color:white;
}
.reset-btn:hover{ background:#ea580c; }
</style>
</head>

<body>

<header>
    <h1>Energy-Efficient CPU Scheduling Simulator</h1>
    <p>Priority Based + DVFS Model</p>
</header>

<div class="container">

<!-- Add Process -->
<div class="card">
<h2>Add Process</h2>
<input id="pid" placeholder="PID">
<input type="number" id="arrival" placeholder="Arrival">
<input type="number" id="burst" placeholder="Burst">
<input type="number" id="priority" placeholder="Priority">
<button onclick="addProcess()">Add</button>
</div>

<!-- Process Table -->
<div class="card">
<h2>Process Table</h2>
<table>
<thead>
<tr>
<th>PID</th>
<th>AT</th>
<th>BT</th>
<th>Priority</th>
<th>Freq</th>
<th>Energy</th>
<th>WT</th>
<th>TAT</th>
<th>Action</th>
</tr>
</thead>
<tbody id="ptable"></tbody>
</table>
</div>

<!-- Run -->
<div class="card">
<h2>Run Scheduler</h2>
<button onclick="runScheduler()">Run Energy-Efficient Scheduling</button>
<button class="reset-btn" onclick="resetAll()">Reset</button>
</div>

<!-- Results -->
<div class="card">
<h2>Average Results</h2>
<p>Average Waiting Time: <b id="avgWT">-</b></p>
<p>Average Turnaround Time: <b id="avgTAT">-</b></p>
<p>Average Energy Consumption: <b id="avgEnergy">-</b></p>
</div>

</div>

<script>
let processes = [];

function addProcess(){
    let pid = pidInput.value.trim();
    let at = +arrival.value;
    let bt = +burst.value;
    let pr = +priority.value;

    if(!pid || bt<=0 || pr<=0){ alert("Invalid input"); return; }
    if(processes.some(p=>p.pid===pid)){ alert("PID exists"); return; }

    processes.push({pid, at, bt, pr});
    pidInput.value=arrival.value=burst.value=priority.value="";
    renderTable();
}

function runScheduler(){
    if(processes.length===0){ alert("No processes"); return; }

    processes.sort((a,b)=> a.pr-b.pr || a.at-b.at);

    let time=0, totalWT=0, totalTAT=0, totalEnergy=0;

    processes.forEach(p=>{
        time = Math.max(time, p.at);

        p.wt = time - p.at;
        p.tat = p.wt + p.bt;

        let voltage, freqLabel, freq;
        if(p.pr<=2){ voltage=1.3; freq=3.0; freqLabel="HIGH"; }
        else if(p.pr<=4){ voltage=1.0; freq=2.0; freqLabel="MEDIUM"; }
        else{ voltage=0.8; freq=1.2; freqLabel="LOW"; }

        p.freq=freqLabel;
        p.energy=(voltage*voltage*freq*p.bt).toFixed(2);

        time+=p.bt;

        totalWT+=p.wt;
        totalTAT+=p.tat;
        totalEnergy+=Number(p.energy);
    });

    avgWT.innerText=(totalWT/processes.length).toFixed(2);
    avgTAT.innerText=(totalTAT/processes.length).toFixed(2);
    avgEnergy.innerText=(totalEnergy/processes.length).toFixed(2);

    renderTable();
}

function deleteProcess(i){
    processes.splice(i,1);
    renderTable();
}

function resetAll(){
    processes=[];
    ptable.innerHTML="";
    avgWT.innerText=avgTAT.innerText=avgEnergy.innerText="-";
}

function renderTable(){
    ptable.innerHTML="";
    processes.forEach((p,i)=>{
        ptable.innerHTML+=`
        <tr>
        <td>${p.pid}</td>
        <td>${p.at}</td>
        <td>${p.bt}</td>
        <td>${p.pr}</td>
        <td class="${p.freq?.toLowerCase()||''}">${p.freq||"-"}</td>
        <td>${p.energy||"-"}</td>
        <td>${p.wt??"-"}</td>
        <td>${p.tat??"-"}</td>
        <td><button class="delete-btn" onclick="deleteProcess(${i})">Delete</button></td>
        </tr>`;
    });
}

const pidInput=pid, arrival=arrival, burst=burst, priority=priority;
</script>

</body>
</html>
